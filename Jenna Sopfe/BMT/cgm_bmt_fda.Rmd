---
title: "CGM and BMT Functional Data Analysis (FDA)"
author: "Tim Vigers & Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
knitr::opts_chunk$set(echo = FALSE)
home_dir = ifelse(.Platform$OS.type != "unix",
                  "Z:/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects/Jenna Sopfe/CGM Accuracy in BMT/",
                  "~/UCD/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects/Jenna Sopfe/CGM Accuracy in BMT/")
knitr::opts_knit$set(root.dir = home_dir)
```

```{r data import}
# Clean
cgm = read.csv("./Data_Cleaned/Prospective HSCT CGM Data Updated 6.24.19 FULL DATA SET.csv",
               na.strings = "")
cgm$Time = mdy_hm(cgm$Time)
cgm$numeric_time = hour(cgm$Time) + minute(cgm$Time)/60
# First CGM wear only
first_cgm = 
  cgm[cgm$SensorNum == 1,c("SubjectID","numeric_time","dx_cat","tx_type","Historic_Glucose")]
# Wide format
t = first_cgm %>% pivot_wider(names_from = numeric_time,values_from = Historic_Glucose)
```
