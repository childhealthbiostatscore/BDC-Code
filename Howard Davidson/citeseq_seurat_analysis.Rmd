---
title: ""
author: "Tim Vigers & Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 5
    toc_float: yes
---

```{r setup, include=FALSE}
library(arsenal)
library(tidyverse)
library(performance)
library(knitr) 
library(pzfx)
# analysis pckgs
library(Seurat) # need these for Differential expression testing
library(SeuratObject)
# library(DESeq2)

# data
home_dir = "S:/Laura/BDC/Projects/Howard Davidson/R01/Data_Raw/Davidson pilot data/"
knitr::opts_knit$set(root.dir = home_dir)
#setwd("S:/Laura/BDC/Projects/Howard Davidson/R01/Data_Raw/Davidson pilot data/")
# cd4_processed = readRDS(paste0(home_dir, "OneDrive_1_6-28-2023/cd4_cells_processed.rds"))
# cd8_processed = readRDS(paste0(home_dir, "OneDrive_1_6-28-2023/cd8_cells_processed.rds"))
df = readRDS(paste0(home_dir, "OneDrive_1_6-28-2023/normalized.rds"))
df2 = SetIdent(df, value= df@meta.data$RNA_clustifyr_celltype_individual)
```

```{r}
levels(df2)
test_de_markers = FindMarkers(df2, ident.1 = "CD4T_Naive", verbose = T, min.pct = .3)


head(test_de_markers)
```
