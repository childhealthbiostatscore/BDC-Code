---
title: "JDRF Data Clean"
author: "Casey Sakamoto"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
library(readxl)
library(tidyverse) # data manipulation
library(lubridate)


knitr::opts_chunk$set(echo = FALSE)
if(Sys.info()["sysname"] == "Windows"){
  home_dir = "S:/Laura/BDC/Projects/Viral Shah/JDRF"
} else if (Sys.info()["sysname"] == "Linux"){
  home_dir = "~/UCD/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects/Viral Shah/JDRF"
} else if (Sys.info()["sysname"] == "Darwin"){
  home_dir = "/Volumes/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects/Viral Shah/JDRF"
}
knitr::opts_knit$set(root.dir = home_dir)



```

## Data notes
- in demographics there is a "comments" variable for group 2 but not group 1

```{r demographics}
# import demographics data
Group_1_Demographic_data =  read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Demographic data_2-3-2022.xlsx", 
    col_types = c("numeric", "numeric", "text", 
        "text", "text", "text", "date", "date", 
        "numeric", "text", "text", "text", 
        "date", "numeric", "numeric", "numeric", 
        "text", "date", "numeric", "text", 
        "text", "text", "text", "text", "text", 
        "text", "text"))

Group_2_Demographic_Data = read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Demographic Data_2-3-2022.xlsx", 
    col_types = c("numeric", "numeric", "text", 
        "text", "text", "text", "date", "text", 
        "date", "numeric", "text", "text", 
        "text", "date", "numeric", "numeric", 
        "numeric", "text", "date", "numeric", 
        "text", "text", "text", "text", "text", 
        "text", "text", "text"))

# add group number variable
Group_1_Demographic_data$group = 1
Group_2_Demographic_Data$group = 2

# note there is a comment variable in group 2 not in group 1
Demographic_data = full_join(Group_1_Demographic_data, Group_2_Demographic_Data)
rm(Group_1_Demographic_data, Group_2_Demographic_Data)
```

```{r lab data}
# need mrn, date, order value, named after sheet

# UrineAlbuminCreatinineRatio
uacr_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "UrineAlbuminCreatinineRatio")
uacr_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "UrineAlbuminCreatinineRatio")
# merge and rename vars
uacr = full_join(uacr_1, uacr_2) %>% select(MRN, ResultDate, OrderValue) %>% rename(uacr_date = ResultDate, uacr = OrderValue)
rm(uacr_1, uacr_2)

# Hemoglobin
hemo_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "Hemoglobin")
hemo_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "Hemoglobin")

hemo = full_join(hemo_1, hemo_2) %>% select(MRN, ResultDate, OrderValue) %>% rename(hemo_date = ResultDate, hemoglobin = OrderValue)

# MCV
MCV_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "MCV")
MCV_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "MCV")

# Serum Ferritin
sf_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "SerumFerritin ")
sf_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "SerumFerritin ")

# TotalIron
ti_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "TotalIron")
ti_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "TotalIron")

# TIBC
tibc_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "TIBC ")
tibc_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "TIBC ")

# transferrinsaturation
ts_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "TransferrinSaturation")
ts_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "TransferrinSaturation")

#total cholesterol
tc_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "TotalCholesterol ")
tc_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "TotalCholesterol ")

# triglycerides
trig_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "Triglycerides ")
trig_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "Triglycerides ")

# HDL
hdl_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "HDL ")
hdl_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "HDL ")

# LDL
ldl_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "LDL")
ldl_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "LDL")


# serumcreatinine
sc_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "SerumCreatinine")
sc_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "SerumCreatinine")

# egfr
egfr_1 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 1_Lab Variables_2-22-2022.xlsx", 
    sheet = "eGFR")
egfr_2 <- read_excel("S:/Laura/BDC/Projects/Viral Shah/JDRF/Data_Raw/Group 2_Lab Variables_2-22-2022.xlsx", 
    sheet = "eGFR")
```
