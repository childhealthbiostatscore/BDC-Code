---
title: "PICLS data cleaning"
author: "Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    number_sections: yes
    theme: readable
    toc: yes
    toc_depth: 3
    toc_float: yes
---
  
```{r setup, include=FALSE}
library(readxl)
library(skimr)
library(DT)
library(dplyr)
```

# Baseline participant questionnaire

```{r }
# Baseline participant questionnaire
#source("C:/Users/pylell/Documents/GitHub/BDC-Code/Sarit Polsky/PICLS/Data cleaning/PICLSStudyHCLVsSAPTI-BaselineDemographics_R_2022-08-16_1707.r")
#baseline <- data
baseline <- read.csv("B:/Projects/Sarit Polsky/PICLS/Data cleaning/Data files/PICLSStudyHCLVsSAPTI-BaselineParticipantQ_DATA_LABELS_2022-08-16_1734.csv",na.strings = c(""," "))
skim(baseline)
datatable(baseline)

baseline$ins_missing <- ifelse(baseline$Health.Insurance...choose.all.that.apply..choice.Aetna.=="Unchecked" &
                                 baseline$Health.Insurance...choose.all.that.apply..choice.Blue.Cross.Blue.Shield.=="Unchecked" &
                                 baseline$Health.Insurance...choose.all.that.apply..choice.Cigna.=="Unchecked" &
                                 baseline$Health.Insurance...choose.all.that.apply..choice.Humana.=="Unchecked" & 
                                 baseline$Health.Insurance...choose.all.that.apply..choice.Medicaid.=="Unchecked" &
                                 baseline$Health.Insurance...choose.all.that.apply..choice.Medicare.=="Unchecked" &
                                 baseline$Health.Insurance...choose.all.that.apply..choice.United.Health.Care.=="Unchecked" &
                                 baseline$Health.Insurance...choose.all.that.apply..choice.Other.=="Unchecked" &
                                 baseline$Health.Insurance...choose.all.that.apply..choice.Tricare.=="Unchecked",1,0)
```

# Obstetric history

```{r }
# obstetric history - enabled as survey
ob_hx <- read.csv("B:/Projects/Sarit Polsky/PICLS/Data cleaning/Data files/PICLSStudyHCLVsSAPTI_DATA_2022-08-17_1712.csv",na.strings = c(""," "))
ob_hx <- ob_hx %>% filter(!is.na(redcap_repeat_instrument))
skim(ob_hx)
datatable(ob_hx)


```

# Preconception

```{r }
# Preconception
precon <- read.csv("B:/Projects/Sarit Polsky/PICLS/Data cleaning/Data files/PICLSStudyHCLVsSAPTI-Preconception_DATA_2022-08-17_1728.csv",na.strings = c(""," "))
skim(precon)
datatable(precon)
```

# Exemption

```{r }
# exemption waiver
waiver <- read.csv("B:/Projects/Sarit Polsky/PICLS/Data cleaning/Data files/PICLSStudyHCLVsSAPTI-ExemptionWaiver_DATA_2022-08-17_2242.csv",na.strings = c(""," "))
waiver[,c("incl___1","incl___2","incl___3","incl___4","incl___5","incl___6","incl___7",
                                     "incl___8","incl___9","incl___10","incl___11","incl___12","incl___13")] <- apply(waiver[,c("incl___1","incl___2","incl___3","incl___4","incl___5","incl___6","incl___7",
                                     "incl___8","incl___9","incl___10","incl___11","incl___12","incl___13")],
                2,as.numeric)

waiver$sum_incl <- rowSums(waiver[,c("incl___1","incl___2","incl___3","incl___4","incl___5","incl___6","incl___7",
                                     "incl___8","incl___9","incl___10","incl___11","incl___12","incl___13")])

skim(waiver)
datatable(waiver)
```